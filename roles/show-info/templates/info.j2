

#################################################################
###    ILKI KUBERNETES ENGINE Installation Information        ###
#################################################################


Thank you for using ILKI KUBERNETES ENGINE to deploy and manage your Kubernetes installation.

This file (agorakube-info.txt) is stored in root home directory for your reference.

#############################################################

##################
# Kubectl config #
##################
Kubectl config file is located at: /root/.kube/config

{% if agorakube_features.dashboard.enabled | bool == True %}
########################
# Kubernetes Dashboard #
########################
Kubernetes dashboard can be accessed by following the steps below:

1. Run follwoing command on deploy (ansible control) machine.
# kubectl proxy

2. Visit following URL on deploy machine.
http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/

{% if agorakube_features.dashboard.generate_admin_token | bool == True %}
3. The Admin token is stored in: /root/.kube/dashboardadmin
{% endif %}
{% endif %}
################################################################################

   Run following command to see this information again anytime.
   $ cat /root/agorakube-info.txt

################################################################################

################################################################################

To automatically install and clone the latest stable AGORAKUBE distribution run following command.

$ bash <(curl -s https://raw.githubusercontent.com/ilkilab/agorakube/master/setup-deploy.sh)

################################################################################

################################################################################

To install the agorakube and deploy the K8s cluster launch the vagrant file which can be found under the file https://github.com/ilkilab/agorakube/tree/master/labs/multi-nodes
to deploy the woker nodes cluster run following command 

$ vagrant up

################################################################################

################################################################################

To deploy  the master nodes cluster lauch the vagrant file wich can be found under the file https://github.com/ilkilab/agorakube/tree/master/labs/all-in-one

$ vagrant up

################################################################################

################################################################################

Run the following command to launch the Ansible playbook that will deploy the pre-configured Kubernetes cluster :

$ sudo ansible-playbook agorakube.yaml

################################################################################

################################################################################

To backup ETCD cluster from Agorakube racine directory 
# Run the following command:

 $ sudo ansible-playbook tools/etcd/backup-etcd-cluster.yaml

################################################################################

To restore ETCD cluster from Agorakube racine directory follow the next steps
 # Edit group_vars/all.yaml file and add the following variable:

restoration_snapshot_file: /path/to/the/backups/file/on/deploy/machine

# Then, from Agorakube racine directory, run the following command:
sudo ansible-playbook tools/etcd/restore-etcd-cluster.yaml

################################################################################

################################################################################

To check the state of the etcd type the command below 
 
ansible-playbook agorakube.yaml --tags check-etcd

################################################################################

################################################################################

To Upgrade/downgrade the etcd cluster edit file "group_vars/all.yaml" with 

agorakube_base_components:
  etcd:
    release: v3.4.14  (Desired ETCD release)
    upgrade: True

################################################################################

################################################################################

To uninstall etcd cluster use following command 

$ ansible-playbook delete-etcd-clusters.yaml --tags uninstall 

################################################################################

################################################################################
To upgrade OpenEBS Storage

To upgrade OpenEBS Jiva volumes in your AGORAKUBE cluster, follow this step

Change in file "./group_vars/all.yaml" the variable agorakube_features.storage.release to the desired OpenEBS release (https://github.com/openebs/openebs/releases) and apply the changes to the cluster

################################################################################

################################################################################

To uninstall OpenEBS Storage use following command 

$ ansible-playbook delete_openebs.yaml --tags uninstall 

################################################################################

################################################################################

To install opa/Gatekeeper on Agorakube make sure to activate 

$ agorakube_features:
  gatekeeper:
    enabled: True

################################################################################

################################################################################

To upgrade And Downgrade Kubernetes with Agorakube Edit "./group_vars/all.yaml" file with the following parameters

agorakube_base_components:
  kubernetes:
    release: v1.21.1  (Desired K8S release)
    upgrade: true
 
################################################################################

################################################################################

To uninstall AGORAKUBE cluster, go to AGORAKUBE source folder located on the deploy machine and run the following command:

ansible-playbook agorakube.yaml --tags uninstall

################################################################################




